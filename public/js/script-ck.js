function loadFestivalMap(){var e=document.getElementsByClassName("lat"),t=document.getElementsByClassName("lon"),n=document.getElementsByClassName("address")[0].firstChild.textContent,r=document.getElementsByClassName("sponsorAddress");for(var i=0;i<r.length;++i)sponsorsPosition[i]=[r[i].firstChild.textContent,"sponsor"+i];console.log(sponsorsPosition);var s=new google.maps.LatLng(e[150].firstChild.textContent,t[150].firstChild.textContent),o={center:s,zoom:festivalMapZoom,maxZoom:festivalMapZoomMax,scrollwheel:!1,minZoom:festivalMapZoomMin,panControl:!1,backgroundColor:"rgba(0,0,0,0)",mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:["map_styles_festival","map_styles_festival_zoomed"]}};festivalMap=new google.maps.Map(document.getElementById("race-map"),o);gGeocoder=new google.maps.Geocoder;gMarker=new google.maps.Marker({position:s,map:festivalMap});festivalMap.mapTypes.set("map_styles_festival",styled_festival);festivalMap.mapTypes.set("map_styles_festival_zoomed",styled_festival_zoomed);festivalMap.setMapTypeId("map_styles_festival_zoomed");for(var i=0;i<e.length;++i)trajet[i]=new google.maps.LatLng(e[i].firstChild.textContent,t[i].firstChild.textContent);elevator=new google.maps.ElevationService;drawPath();var u=function(e,t){gGeocoder.geocode({address:e,region:"BE"},function(e,n){t.setPosition(e[0].geometry.location)})};u(n,gMarker);for(var i=0;i<sponsorsPosition.length;++i)sponsorsPosition[i][1]=new google.maps.Marker({position:s,map:festivalMap,icon:{url:"http://pfe/uploads/races/1/sponsors/100x100_crop/522977_399909913394501_164909558_n.jpg",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},shape:{coord:[0,0,50],type:"circle"},zIndex:102});google.maps.event.addListener(festivalMap,"zoom_changed",function(){var e=festivalMap.getZoom();e>6?festivalMap.setMapTypeId("map_styles_festival_zoomed"):festivalMap.setMapTypeId("map_styles_festival")})}function drawPath(){chart=new google.visualization.ColumnChart(document.getElementById("elevation_chart"));var e=trajet,t={path:e,samples:256};elevator.getElevationAlongPath(t,plotElevation)}function plotElevation(e,t){if(t!=google.maps.ElevationStatus.OK)return;var n=e,r=[];for(var i=0;i<e.length;i++)r.push(n[i].location);var s={path:r,strokeColor:"rgb(244,129,64)",opacity:.4,map:festivalMap};polyline=new google.maps.Polyline(s);var o=new google.visualization.DataTable;o.addColumn("string","Sample");o.addColumn("number","Elevation");for(var i=0;i<e.length;i++)o.addRow(["",n[i].elevation]);document.getElementById("elevation_chart").style.width="auto";chart.draw(o,{chartType:"LineChart",height:150,colors:["#90A1BF"],width:"auto",legend:"none",titleY:"Elevation (m)",titleX:"Distance"})}var style_festival=[{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{color:"#90A1BF"}]},{featureType:"water",stylers:[{visibility:"on"},{color:"#ffffff"}]}],style_festival_zoomed=[{featureType:"administrative",stylers:[{visibility:"on"}]},{featureType:"poi",stylers:[{visibility:"on"}]},{featureType:"transit",stylers:[{visibility:"on"}]},{featureType:"road",stylers:[{visibility:"simplified"},{color:"#90A1BF"}]},{featureType:"water",stylers:[{visibility:"on"}]},{featureType:"landscape",stylers:[{visibility:"off"}]}],styled_festival=new google.maps.StyledMapType(style_festival,{name:"Festival style"}),styled_festival_zoomed=new google.maps.StyledMapType(style_festival_zoomed,{name:"Festival style zoomed"}),festivalMapZoom=13,festivalMapZoomMax=18,festivalMapZoomMin=4;google.load("visualization","1.0",{packages:["corechart"]});var festivalMap,elevator,chart,infowindow=new google.maps.InfoWindow,polyline,trajet=[],gMarker,startPosition,sponsorsPosition=[],gGeocoder;google.maps.event.addDomListener(window,"load",loadFestivalMap);